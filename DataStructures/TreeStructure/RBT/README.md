# Красно-черное дерево

## Что такое красно-черное дерево?
Красно-черное дерево (Red-Black Tree) — это самобалансирующееся бинарное дерево поиска (BST), в котором каждое узловое звено окрашено в один из двух цветов: красный или черный. Эта структура данных используется для поддержания сбалансированности дерева, что позволяет выполнять основные операции (поиск, вставку, удаление) за **логарифмическое время** O(log n).

## Основные свойства красно-черного дерева
Чтобы гарантировать балансировку, красно-черное дерево должно соблюдать следующие правила:

1. **Каждый узел окрашен в красный или черный цвет.**
2. **Корень дерева всегда черный.**
3. **Каждый NULL-узел считается черным.**
4. **Если узел красный, то оба его дочерних узла должны быть черными (отсутствие двух подряд идущих красных узлов).**
5. **Любой путь от корня до листа содержит одинаковое количество черных узлов (черная высота дерева).**

Эти свойства позволяют дереву оставаться сбалансированным, предотвращая рост одной ветви значительно больше другой.

## Методы, используемые в красно-черном дереве
Красно-черное дерево поддерживает стандартные операции бинарного дерева поиска, а также включает дополнительные методы для поддержания балансировки:

### 1. **Поиск (Search)**
   - Работает так же, как в обычном бинарном дереве поиска: рекурсивно или итеративно.
   - Время выполнения — O(log n).

### 2. **Вставка (Insertion)**
   - Новый узел вставляется как в обычное бинарное дерево поиска.
   - Затем выполняется балансировка, используя **перекрашивание** и **левый/правый повороты**.
   - Время выполнения — O(log n).

### 3. **Удаление (Deletion)**
   - После удаления узла может нарушиться балансировка, поэтому применяются специальные процедуры.
   - Используется **замена узла** и балансировка путем **перекрашивания** и **вращений**.
   - Время выполнения — O(log n).

### 4. **Левый и правый поворот (Left and Right Rotation)**
   - Используются для корректировки структуры дерева после вставки или удаления.
   - Позволяют уменьшить глубину длинных ветвей, перераспределяя узлы.
   - Время выполнения — O(1).

#### Пример левого поворота:
Допустим, у нас есть следующее дерево:
```
    10 (черный)
      \
      20 (красный)
         \
         30 (красный)
```
После левого поворота вокруг узла `10` структура дерева изменится:
```
      20 (черный)
     /   \
  10 (красный) 30 (красный)
```
Левый поворот помогает сбалансировать дерево, перемещая узлы таким образом, чтобы избежать длинных правых ветвей.

### 5. **Перекрашивание (Recoloring)**
   - Меняет цвета узлов для соблюдения правил красно-черного дерева.
   - Используется вместе с поворотами при балансировке.
   - Время выполнения — O(1).

#### Пример перекрашивания:
Допустим, после вставки нового узла дерево принимает вид:
```
    10 (черный)
   /    \
  5 (красный) 20 (красный)
```
Такое дерево нарушает правило, что красный узел не может иметь красного потомка. В этом случае перекрашивание исправит баланс:
```
    10 (красный)
   /    \
  5 (черный) 20 (черный)
```
Если после перекрашивания корень становится красным, он всегда перекрашивается в черный, чтобы сохранить свойство красно-черного дерева.

## Чем красно-черное дерево отличается от обычного бинарного дерева поиска?

Обычное **бинарное дерево поиска (BST)** не гарантирует балансировки, что может привести к вырождению в **связный список** в худшем случае (например, при последовательной вставке отсортированных данных). Это делает операции поиска, вставки и удаления **линейными (O(n))**.

Красно-черное дерево, благодаря своим свойствам, гарантирует балансировку и выполняет все основные операции за **O(log n)** в худшем случае. Это особенно полезно в **базах данных**, **компиляхторах**, **сетевых алгоритмах** и других приложениях, где важна предсказуемая эффективность операций.

## Где применяется красно-черное дерево?
- **Внутренние структуры данных STL (C++ std::map, std::set).**
- **Файловые системы (например, ext3 и ext4 в Linux используют красно-черные деревья для индексации данных).**
- **Базы данных (в частности, B-деревья могут использоваться совместно с красно-черными деревьями).**
- **Планировщики задач и многопоточные среды (для эффективного хранения и обработки событий во времени).**

## Заключение
Красно-черные деревья — это эффективная структура данных, обеспечивающая **логарифмическое время работы** операций и гарантированную балансировку. Они активно используются в различных алгоритмах и системах, где важна скорость работы с динамическими структурами данных.